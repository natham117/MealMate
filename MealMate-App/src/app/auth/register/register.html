<div class="auth-card">
    <h1>Registrieren</h1>

    <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
        <!-- Voller Name -->
        <label for="fullName">Voller Name</label>
        <input
            id="fullName"
            name="fullName"
            type="text"
            placeholder="z. B. Max Mustermann"
            autocomplete="name"
            formControlName="fullName"
        />

        <!-- E-Mail -->
        <label for="email">E-Mail</label>
        <input
            id="email"
            name="email"
            type="email"
            placeholder="z. B. max@mustermann.de"
            autocomplete="email"
            formControlName="email"
        />
        <div class="error" *ngIf="form.get('email')?.touched && form.get('email')?.errors">
            Bitte E-Mail-Richtlinien beachten.
        </div>

        <!-- Benutzername -->
        <label for="username">Benutzername</label>
        <input
            id="username"
            name="username"
            type="text"
            placeholder="z. B. mustermannmax123"
            autocomplete="username"
            formControlName="username"
        />

        <!-- Geburtsdatum -->
        <label for="username">Geburtsdatum</label>
        <input
            id="birthdate"
            name="birthdate"
            type="date"
            autocomplete="bday"
            formControlName="birthdate"
        />

        <!-- Geschlecht -->
        <label for="gender">Geschlecht</label>
        <select id="gender" name="gender" autocomplete="sex" formControlName="gender">
            <option value="" selected>Bitte auswählen</option>
            <option value="female">Weiblich</option>
            <option value="male">Männlich</option>
            <option value="diverse">Divers</option>
            <option value="none">Keine Angabe</option>
        </select>


        <!-- Passwortbereich -->
        <div formGroupName="passwordGroup">
        <!-- Passwort -->
            <label for="password">Passwort</label>
            <input
                id="password"
                name="password"
                type="password"
                placeholder="********"
                autocomplete="new-password"
                formControlName="password"
            />

            <!-- Fehlermeldungen für Passwort -->
            <div class="error" *ngIf="form.get('passwordGroup.password')?.touched && form.get('passwordGroup.password')?.errors">
                Bitte Passwort-Richtlinien beachten
            </div>

            <!-- Passwort wiederholen -->
            <label for="passwordConfirm">Passwort wiederholen</label>
            <input
                id="passwordConfirm"
                name="passwordConfirm"
                type="password"
                placeholder="Passwort erneut eingeben"
                autocomplete="new-password"
                formControlName="passwordConfirm"
            />

            <!-- Fehlermeldung für Nicht-Übereinstimmung -->
            <!-- <div class="error" *ngIf="form.get('passwordGroup')?.touched && form.get('passwordGroup')?.errors?.passwordsNotMatch"> -->
            <div class="error" *ngIf="form.get('passwordGroup')?.touched && form.get('passwordGroup')?.errors?.['passwordsNotMatch']">
                Passwörter stimmen nicht überein.
            </div>
        </div>
        
        <!-- Submit -->
        <button type="submit">Konto erstellen</button>

        <p class="hint">
            Schon registriert?
            <a routerLink="/login">Jetzt anmelden.</a>
        </p>
    </form>
</div>

<div class="mm-modal-backdrop" *ngIf="modalOpen()" (click)="closeModal()"></div>
<div class="mm-modal" *ngIf="modalOpen()">
    <h2>{{ modalTitle() }}</h2>

    <ng-container *ngIf="modalBody() === null">
        <ng-container *ngIf="showEmailRules()">
            <h3>E-Mail-Richtlinien</h3>
            <ul>
                <li>Format: <code>local-part@domain</code></li>
                <li>Local-part: Buchstaben/Ziffern und . ! # $ % &amp; ' * + / = ? ^ _ | &lbrace; ~ &rbrace; ` -</li>
                <li>Local-part: Nicht mit . beginnen/enden, keine ".."</li>
                <li>Local-part: Max. 64 Zeichen</li>
                <li>Domain: Labels durch Punkt, jedes Label beginnt/endet mit Buchstabe/Zahl, "-" nur in der Mitte</li>
                <li>Domain: Label maximal 64 Zeichen, gesamt maximal 254 Zeichen</li>
                <li>TLD: mindestens 2 Buchstaben (z. B. <code>de</code>, <code>com</code>)</li>
                <li>Keine Leer- oder Steuerzeichen</li>
            </ul>
        </ng-container>

        <ng-container *ngIf="showPasswordRules()">
            <h3>Passwort-Richtlinien</h3>
                <ul>
                <li>Mindestens 8 Zeichen</li>
                <li>Mindestens eine Zahl</li>
                <li>Mindestens ein Groß-/Kleinbuchstabe</li>
                <li>Keine Leer- oder Unicode-Steuerzeichen</li>
                <li>Passwort und Wiederholung müssen übereinstimmen</li>
            </ul>
        </ng-container>
    </ng-container>


    <ng-container *ngIf="modalBody() !== null">
        <p>{{ modalBody() }}</p>
    </ng-container>

    <div class="mm-modal-actions">
        <button type="button" (click)="closeModal()">OK</button>
    </div>
</div>